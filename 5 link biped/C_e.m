function [C] = C_e(q,dq)

  C(1,1)=dq(4)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 +...
          (8*sin(q(2) + q(4)))/5 - (34029*sin(q(4)))/6250) - dq(5)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 -...
          (512*sin(q(3) - q(2) + q(5)))/3125 + (512*sin(q(5)))/3125) - dq(3)*((5971*sin(q(2) - q(3)))/6250 + (512*...
         sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) + dq(2)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125 + (8*sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5);
  C(1,2)=dq(4)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 +...
          (8*sin(q(2) + q(4)))/5 - (34029*sin(q(4)))/6250) + dq(1)*((5971*sin(q(2) - q(3)))/6250 + (512*...
         sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125 + (8*sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5) + dq(2)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) -...
          q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125 + (8*...
         sin(q(2) + q(4)))/5 + (8*sin(q(2)))/5);
  C(1,3)=- dq(5)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125 +...
          (512*sin(q(5)))/3125) - dq(1)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 +...
          (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) - dq(3)*((5971*sin(q(2) -...
          q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) -...
          q(2) + q(5)))/3125);
  C(1,4)=((dq(1) + dq(2) + dq(4))*(1024*sin(q(2) - q(3) + q(4) - q(5)) + 5971*sin(q(2) - q(3) +...
          q(4)) + 10000*sin(q(2) + q(4)) - 34029*sin(q(4))))/6250;
  C(1,5)=-(512*(sin(q(2) - q(3) + q(4) - q(5)) - sin(q(3) - q(2) + q(5)) + sin(q(5)))*(dq(1) +...
          dq(3) + dq(5)))/3125;
  C(1,6)=0;
  C(1,7)=0;
  C(2,1)=(512*dq(1)*sin(q(3) - q(2) + q(5)))/3125 - (512*dq(3)*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 - (512*dq(5)*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (5971*dq(1)*sin(q(2) - q(3) + q(4)))/6250 - (512*...
         dq(1)*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (5971*dq(3)*sin(q(2) - q(3) + q(4)))/6250 + (512*dq(3)*...
         sin(q(3) - q(2) + q(5)))/3125 + (512*dq(5)*sin(q(3) - q(2) + q(5)))/3125 - (8*dq(1)*sin(q(2) + q(4)))/5 - (8*...
         dq(1)*sin(q(2)))/5 - (34029*dq(4)*sin(q(4)))/6250 - (5971*dq(1)*sin(q(2) - q(3)))/6250 - (5971*dq(3)*...
         sin(q(2) - q(3)))/6250;
  C(2,2)=-(34029*dq(4)*sin(q(4)))/6250;
  C(2,3)=- dq(1)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) - dq(3)*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) - dq(5)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125);
  C(2,4)=-(34029*sin(q(4))*(dq(1) + dq(2) + dq(4)))/6250;
  C(2,5)=-(512*(sin(q(2) - q(3) + q(4) - q(5)) - sin(q(3) - q(2) + q(5)))*(dq(1) + dq(3) + dq(5)))/3125;
  C(2,6)=0;
  C(2,7)=0;
  C(3,1)=dq(1)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) + dq(2)*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) - (512*dq(5)*sin(q(5)))/3125 + dq(4)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250);
  C(3,2)=dq(1)*((5971*sin(q(2) - q(3)))/6250 + (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) + q(5)))/3125) + dq(2)*((5971*sin(q(2) - q(3)))/6250 +...
          (512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 - (512*sin(q(3) - q(2) +...
          q(5)))/3125) + dq(4)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250);
  C(3,3)=-(512*dq(5)*sin(q(5)))/3125;
  C(3,4)=((1024*sin(q(2) - q(3) + q(4) - q(5)) + 5971*sin(q(2) - q(3) + q(4)))*(dq(1) + dq(2) + dq(4)))/6250;
  C(3,5)=-(512*sin(q(5))*(dq(1) + dq(3) + dq(5)))/3125;
  C(3,6)=0;
  C(3,7)=0;
  C(4,1)=(34029*dq(2)*sin(q(4)))/6250 - (512*dq(5)*sin(q(2) - q(3) + q(4) - q(5)))/3125 - dq(1)*...
         ((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250 + (8*sin(q(2) +...
          q(4)))/5 - (34029*sin(q(4)))/6250) - dq(3)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*sin(q(2) -...
          q(3) + q(4)))/6250);
  C(4,2)=(34029*sin(q(4))*(dq(1) + dq(2)))/6250;
  C(4,3)=- (512*dq(5)*sin(q(2) - q(3) + q(4) - q(5)))/3125 - dq(1)*((512*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 + (5971*sin(q(2) - q(3) + q(4)))/6250) - dq(3)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (5971*...
         sin(q(2) - q(3) + q(4)))/6250);
  C(4,4)=0;
  C(4,5)=-(512*sin(q(2) - q(3) + q(4) - q(5))*(dq(1) + dq(3) + dq(5)))/3125;
  C(4,6)=0;
  C(4,7)=0;
  C(5,1)=dq(1)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125 +...
          (512*sin(q(5)))/3125) + (512*dq(4)*sin(q(2) - q(3) + q(4) - q(5)))/3125 + (512*dq(3)*sin(q(5)))/3125 +...
          dq(2)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125);
  C(5,2)=(512*dq(4)*sin(q(2) - q(3) + q(4) - q(5)))/3125 + dq(1)*((512*sin(q(2) - q(3) + q(4) -...
          q(5)))/3125 - (512*sin(q(3) - q(2) + q(5)))/3125) + dq(2)*((512*sin(q(2) - q(3) + q(4) - q(5)))/3125 - (512*...
         sin(q(3) - q(2) + q(5)))/3125);
  C(5,3)=(512*sin(q(5))*(dq(1) + dq(3)))/3125;
  C(5,4)=(512*sin(q(2) - q(3) + q(4) - q(5))*(dq(1) + dq(2) + dq(4)))/3125;
  C(5,5)=0;
  C(5,6)=0;
  C(5,7)=0;
  C(6,1)=dq(2)*((9744*sin(q(1) + q(2) + q(4)))/625 + (34029*sin(q(1) + q(2)))/2500) - dq(3)*((256*...
         sin(q(1) + q(3) + q(5)))/625 + (5971*sin(q(1) + q(3)))/2500) - dq(1)*((256*sin(q(1) + q(3) + q(5)))/625 -...
          (9744*sin(q(1) + q(2) + q(4)))/625 - (34029*sin(q(1) + q(2)))/2500 + (5971*sin(q(1) + q(3)))/2500 + 4*...
         sin(q(1))) + (9744*dq(4)*sin(q(1) + q(2) + q(4)))/625 - (256*dq(5)*sin(q(1) + q(3) + q(5)))/625;
  C(6,2)=dq(1)*((9744*sin(q(1) + q(2) + q(4)))/625 + (34029*sin(q(1) + q(2)))/2500) + dq(2)*((9744*...
         sin(q(1) + q(2) + q(4)))/625 + (34029*sin(q(1) + q(2)))/2500) + (9744*dq(4)*sin(q(1) + q(2) + q(4)))/625;
  C(6,3)=- dq(1)*((256*sin(q(1) + q(3) + q(5)))/625 + (5971*sin(q(1) + q(3)))/2500) - dq(3)*((256*...
         sin(q(1) + q(3) + q(5)))/625 + (5971*sin(q(1) + q(3)))/2500) - (256*dq(5)*sin(q(1) + q(3) + q(5)))/625;
  C(6,4)=(9744*sin(q(1) + q(2) + q(4))*(dq(1) + dq(2) + dq(4)))/625;
  C(6,5)=-(256*sin(q(1) + q(3) + q(5))*(dq(1) + dq(3) + dq(5)))/625;
  C(6,6)=0;
  C(6,7)=0;
  C(7,1)=dq(2)*((9744*cos(q(1) + q(2) + q(4)))/625 + (34029*cos(q(1) + q(2)))/2500) - dq(3)*((256*...
         cos(q(1) + q(3) + q(5)))/625 + (5971*cos(q(1) + q(3)))/2500) - dq(1)*((256*cos(q(1) + q(3) + q(5)))/625 -...
          (9744*cos(q(1) + q(2) + q(4)))/625 - (34029*cos(q(1) + q(2)))/2500 + (5971*cos(q(1) + q(3)))/2500 + 4*...
         cos(q(1))) + (9744*dq(4)*cos(q(1) + q(2) + q(4)))/625 - (256*dq(5)*cos(q(1) + q(3) + q(5)))/625;
  C(7,2)=dq(1)*((9744*cos(q(1) + q(2) + q(4)))/625 + (34029*cos(q(1) + q(2)))/2500) + dq(2)*((9744*...
         cos(q(1) + q(2) + q(4)))/625 + (34029*cos(q(1) + q(2)))/2500) + (9744*dq(4)*cos(q(1) + q(2) + q(4)))/625;
  C(7,3)=- dq(1)*((256*cos(q(1) + q(3) + q(5)))/625 + (5971*cos(q(1) + q(3)))/2500) - dq(3)*((256*...
         cos(q(1) + q(3) + q(5)))/625 + (5971*cos(q(1) + q(3)))/2500) - (256*dq(5)*cos(q(1) + q(3) + q(5)))/625;
  C(7,4)=(9744*cos(q(1) + q(2) + q(4))*(dq(1) + dq(2) + dq(4)))/625;
  C(7,5)=-(256*cos(q(1) + q(3) + q(5))*(dq(1) + dq(3) + dq(5)))/625;
  C(7,6)=0;
  C(7,7)=0;

 